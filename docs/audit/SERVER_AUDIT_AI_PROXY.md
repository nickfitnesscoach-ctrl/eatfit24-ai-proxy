# –û—Ç—á—ë—Ç –ø–æ –∞—É–¥–∏—Ç—É —Å–µ—Ä–≤–µ—Ä–∞ ‚Äî EatFit24 AI Proxy

**–î–∞—Ç–∞:** 2025-12-22
**–°–µ—Ä–≤–µ—Ä:** 100.84.210.65 (Timeweb NL / Tailscale)
**–°–µ—Ä–≤–∏—Å:** eatfit24-ai-proxy
**–ê—É–¥–∏—Ç–æ—Ä:** –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä–Ω—ã–π –∞—É–¥–∏—Ç

---

## –†–µ–∑—é–º–µ

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –°—Ç–∞—Ç—É—Å |
|----------|--------|
| –ö–æ–¥ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—é | ‚úÖ PASS |
| –ù–µ—Ç —Å–µ–∫—Ä–µ—Ç–æ–≤/–º—É—Å–æ—Ä–∞ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ | ‚úÖ PASS |
| –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å Docker | ‚úÖ PASS |
| –ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ | ‚ö†Ô∏è PASS –° –ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–Ø–ú–ò |
| –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ | ‚ö†Ô∏è PASS –° –ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–Ø–ú–ò |

**–ò—Ç–æ–≥–æ–≤—ã–π –≤–µ—Ä–¥–∏–∫—Ç:** üü° **–ì–û–¢–û–í –ö –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Æ –° –ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–Ø–ú–ò**

---

## 1. –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–µ—Ä–≤–µ—Ä–µ

### –°–∏—Å—Ç–µ–º–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
- **Hostname:** 6133323-qv41688
- **–û–°:** Linux 6.8.0-88-generic (Ubuntu)
- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:** x86_64
- **–í–µ—Ä—Å–∏—è Docker:** 29.1.3
- **–í–µ—Ä—Å–∏—è Docker Compose:** v5.0.0

### –°–µ—Ç–µ–≤—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
```
127.0.0.1/8          - Loopback
185.171.80.128/24    - –ü—É–±–ª–∏—á–Ω—ã–π IP (eth0)
100.84.210.65/32     - Tailscale VPN
172.17.0.1/16        - Docker bridge
172.18.0.1/16        - Docker compose —Å–µ—Ç—å
```

---

## 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç–æ–≥–æ –∫–æ–¥–∞

### Git —Å—Ç–∞—Ç—É—Å
```bash
–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ: /opt/eatfit24-ai-proxy
–í–µ—Ç–∫–∞: master
–°—Ç–∞—Ç—É—Å: —á–∏—Å—Ç—ã–π (–Ω–µ—Ç –Ω–µ–æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤, –Ω–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π)
–ü–æ—Å–ª–µ–¥–Ω–∏–π –∫–æ–º–º–∏—Ç: bf8cd08 - "Merge remote changes with repository cleanup"
```

‚úÖ **PASS:** –ö–æ–¥ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—é.

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
```
/opt/eatfit24-ai-proxy/
‚îú‚îÄ‚îÄ .dockerignore
‚îú‚îÄ‚îÄ .env                    # –ü—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç (–ø—Ä–∞–≤–∞ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å 600)
‚îú‚îÄ‚îÄ .env.example
‚îú‚îÄ‚îÄ .git/
‚îú‚îÄ‚îÄ .github/
‚îú‚îÄ‚îÄ .gitignore
‚îú‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ auth.py
‚îÇ   ‚îú‚îÄ‚îÄ config.py
‚îÇ   ‚îú‚îÄ‚îÄ main.py
‚îÇ   ‚îú‚îÄ‚îÄ openrouter_client.py
‚îÇ   ‚îî‚îÄ‚îÄ schemas.py
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ docs/
‚îÇ   ‚îú‚îÄ‚îÄ API_CONTRACT.md
‚îÇ   ‚îú‚îÄ‚îÄ ENV_CONTRACT.md
‚îÇ   ‚îî‚îÄ‚îÄ RUNBOOK.md
‚îú‚îÄ‚îÄ requirements.txt
‚îî‚îÄ‚îÄ tests/
    ‚îî‚îÄ‚îÄ assets/
        ‚îî‚îÄ‚îÄ test_food_image.jpg  # OK (—Ç–µ—Å—Ç–æ–≤—ã–π –∞—Å—Å–µ—Ç)
```

‚úÖ **PASS:** –ú—É—Å–æ—Ä–Ω—ã–µ —Ñ–∞–π–ª—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã (–Ω–µ—Ç `nul`, `*.log`, –ª–∏—à–Ω–∏—Ö —Ç–µ—Å—Ç–æ–≤—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, `__pycache__`, `venv/`).

---

## 3. –°—Ç–∞—Ç—É—Å Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

### –ó–∞–ø—É—â–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
```
NAME                STATUS                  HEALTH    IMAGE
eatfit24-ai-proxy   Up 11 minutes          healthy   eatfit24-ai-proxy-ai-proxy
```

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
```yaml
# –ò–∑ docker-compose.yml
–ü–æ–ª–∏—Ç–∏–∫–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞:  unless-stopped
–õ–∏–º–∏—Ç –ø–∞–º—è—Ç–∏:         512m
–õ–∏–º–∏—Ç CPU:            0.5 —è–¥—Ä–∞
Health Check:         –ö–∞–∂–¥—ã–µ 30—Å, timeout 10—Å
–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:          json-file (max 10m √ó 3 —Ñ–∞–π–ª–∞)
```

‚úÖ **PASS:** –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑–∞–ø—É—â–µ–Ω –∏ –∑–¥–æ—Ä–æ–≤.

---

## 4. –ê—É–¥–∏—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### 4.1 –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (Non-Root)
```bash
$ docker exec eatfit24-ai-proxy id
uid=1000(appuser) gid=1000(appuser) groups=1000(appuser),100(users)
```

‚úÖ **PASS:** –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç –∏–º–µ–Ω–∏ –Ω–µ–ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è `appuser` (uid=1000).

### 4.2 –°–µ—Ç–µ–≤–∞—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å
```bash
Port Binding: 0.0.0.0:8001 -> 8001/tcp
```

‚ö†Ô∏è **–ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–ï:** Docker –ø—Ä–∏–≤—è–∑–∞–Ω –∫ `0.0.0.0:8001` (–≤—Å–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã).

–û–¥–Ω–∞–∫–æ **firewall (ufw) –∑–∞—â–∏—â–∞–µ—Ç —Å–µ—Ä–≤–∏—Å:**

```bash
Status: active

To                    Action      From
--                    ------      ----
8001/tcp              ALLOW       100.0.0.0/8  # –¢–æ–ª—å–∫–æ Tailscale
```

‚úÖ **–°–ú–Ø–ì–ß–ï–ù–ò–ï:** ufw –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –ø–æ—Ä—Ç 8001 —Å–µ—Ç—å—é Tailscale (100.0.0.0/8).

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
–†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–≤—è–∑–∫–∏ Docker –Ω–∞–ø—Ä—è–º—É—é –∫ IP Tailscale –≤ `docker-compose.yml`:
```yaml
ports:
  - "100.84.210.65:8001:8001"  # –í–º–µ—Å—Ç–æ 0.0.0.0
```
–≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —ç—à–µ–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—É—é –∑–∞—â–∏—Ç—É (firewall + —è–≤–Ω–∞—è –ø—Ä–∏–≤—è–∑–∫–∞).

### 4.3 –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```bash
OPENROUTER_API_KEY=sk-or-v1-3e1d...ae4ce502  # –ü—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç
OPENROUTER_MODEL=openai/gpt-5-image-mini      # –ö–∞—Å—Ç–æ–º–Ω–∞—è –º–æ–¥–µ–ª—å
API_PROXY_SECRET=c6b837b1...67a44a5c          # –ü—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç (64 hex chars)
LOG_LEVEL=DEBUG
```

‚úÖ **PASS:** –í—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç.
‚ö†Ô∏è **–ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–ï:** LOG_LEVEL=DEBUG –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å INFO).
‚ö†Ô∏è **–ò–ù–§–û:** –ú–æ–¥–µ–ª—å `openai/gpt-5-image-mini` (–Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è, —Ç—Ä–µ–±—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤ OpenRouter).

### 4.4 –£—Ç–µ—á–∫–∞ —Å–µ–∫—Ä–µ—Ç–æ–≤
- –§–∞–π–ª `.env` —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–µ–∫—Ä–µ—Ç—ã (–æ–∂–∏–¥–∞–µ–º–æ).
- ‚ö†Ô∏è **–ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–ï:** –ü—Ä–∞–≤–∞ —Ñ–∞–π–ª–∞ –Ω–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã. –î–æ–ª–∂–Ω—ã –±—ã—Ç—å `chmod 600 .env`.

---

## 5. –¢–µ—Å—Ç—ã —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ API

### 5.1 Health Endpoint
```bash
$ curl http://localhost:8001/health
{"status":"ok"}
```
‚úÖ **PASS:** Health check –æ—Ç–≤–µ—á–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.

### 5.2 –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (–Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–π —Ç–µ—Å—Ç)
```bash
$ curl -X POST http://localhost:8001/api/v1/ai/recognize-food
{
  "detail": [
    {"type":"missing","loc":["header","x-api-key"],"msg":"Field required"},
    {"type":"missing","loc":["body","image"],"msg":"Field required"}
  ]
}
```
‚úÖ **PASS:** –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–π API –∫–ª—é—á –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–∫–ª–æ–Ω—ë–Ω (422 validation error).

### 5.3 –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (–ø–æ–∑–∏—Ç–∏–≤–Ω—ã–π —Ç–µ—Å—Ç)
```bash
$ curl -X POST http://localhost:8001/api/v1/ai/recognize-food \
  -H "X-API-Key: c6b837b1..." \
  -F "image=@test_food_image.jpg"

HTTP/1.1 500 Internal Server Error
X-Request-ID: 812bbe6d

{
  "detail": "AI service error: Invalid data type in AI response:
  1 validation error for FoodItem\ncarbohydrates\n
  Field required [type=missing, input_value={...,'carbs': 0.0}]"
}
```

‚ö†Ô∏è **–ù–ê–ô–î–ï–ù–ê –ü–†–û–ë–õ–ï–ú–ê:** –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –≤–∞–ª–∏–¥–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞ AI –ø–∞–¥–∞–µ—Ç.

**–ü—Ä–∏—á–∏–Ω–∞:**
- –ú–æ–¥–µ–ª—å OpenRouter –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ–ª–µ `carbs`.
- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ–∂–∏–¥–∞–µ—Ç –ø–æ–ª–µ `carbohydrates`.
- –ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –º–µ–∂–¥—É –≤—ã–≤–æ–¥–æ–º –º–æ–¥–µ–ª–∏ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π —Å—Ö–µ–º—ã –≤ [app/schemas.py](app/schemas.py).

**–î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞ –∏–∑ –ª–æ–≥–æ–≤:**
```json
{"msg": "OpenRouter token usage: prompt=1162, completion=1162, total=2324"}
{"level": "ERROR", "msg": "Invalid data type in AI response: ...carbohydrates\n  Field required..."}
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
–≠—Ç–∞ –ø—Ä–æ–±–ª–µ–º–∞ –ø—Ä–µ–¥–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ –±—ã–ª–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –≤ –∫–æ–º–º–∏—Ç–µ `78e8a93` ("Remove Pydantic aliases, accept both kcal/calories from LLM"). –û–¥–Ω–∞–∫–æ –ø—Ä–æ–±–ª–µ–º–∞ `carbohydrates` vs `carbs` —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è. –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:
1. –ë—ã–ª –ª–∏ —Ñ–∏–∫—Å —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç (–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ: bf8cd08 –∏–¥—ë—Ç –ø–æ—Å–ª–µ 78e8a93).
2. –ü–æ–∫—Ä—ã–≤–∞–µ—Ç –ª–∏ —Ñ–∏–∫—Å `carbs` ‚Üí `carbohydrates` (—Ç—Ä–µ–±—É–µ—Ç—Å—è code review [app/openrouter_client.py:L1-L400](app/openrouter_client.py)).

---

## 6. –õ–æ–≥–∏ –∏ –Ω–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å

### 6.1 –§–æ—Ä–º–∞—Ç –ª–æ–≥–æ–≤
```json
{
  "ts": "2025-12-22T13:43:22",
  "level": "INFO",
  "logger": "app.main",
  "msg": "Request completed: POST /api/v1/ai/recognize-food -> 500",
  "request_id": "812bbe6d",
  "path": "/api/v1/ai/recognize-food",
  "method": "POST",
  "status": 500,
  "duration_ms": 21184.88,
  "client_ip": "172.18.0.1"
}
```

‚úÖ **PASS:** –õ–æ–≥–∏ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–º JSON —Ñ–æ—Ä–º–∞—Ç–µ —Å–æ –≤—Å–µ–º–∏ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º–∏ –ø–æ–ª—è–º–∏:
- `ts` (timestamp)
- `level`
- `msg`
- `request_id`
- `path`, `method`, `status`
- `duration_ms`
- `client_ip`

### 6.2 –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ç–æ–∫–µ–Ω–æ–≤
```json
{
  "msg": "OpenRouter token usage: prompt=1162, completion=1162, total=2324",
  "request_id": "812bbe6d"
}
```

‚úÖ **PASS:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è –¥–ª—è —É—Å–ø–µ—à–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ OpenRouter.

### 6.3 –†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ Request ID
```bash
Response header: X-Request-ID: 812bbe6d
```

‚úÖ **PASS:** Request ID –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è, –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ –æ—Ç–≤–µ—Ç–∞.

---

## 7. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤

### –¢–µ–∫—É—â–µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ (—Å–Ω–∏–º–æ–∫)
```
CONTAINER          CPU %     MEM USAGE / LIMIT   MEM %
eatfit24-ai-proxy  0.25%     54.22MiB / 512MiB   10.59%
```

‚úÖ **PASS:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –Ω–∏–∂–µ –ª–∏–º–∏—Ç–æ–≤:
- –ü–∞–º—è—Ç—å: 54MB / 512MB (10.6%)
- CPU: 0.25% / 0.5 —è–¥—Ä–∞ (50% –æ—Ç –ª–∏–º–∏—Ç–∞)

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –õ–∏–º–∏—Ç—ã —Ä–µ—Å—É—Ä—Å–æ–≤ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è —á–µ—Ä–µ–∑ –¥–∏—Ä–µ–∫—Ç–∏–≤—ã Docker Compose `mem_limit` –∏ `cpus` (—Ñ–æ—Ä–º–∞—Ç v2+).

---

## 8. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è vs –†–µ–∞–ª—å–Ω–æ—Å—Ç—å

### 8.1 ENV_CONTRACT.md
| –ê—Å–ø–µ–∫—Ç | –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è | –†–µ–∞–ª—å–Ω–æ—Å—Ç—å | –°—Ç–∞—Ç—É—Å |
|--------|--------------|------------|--------|
| `OPENROUTER_API_KEY` | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ | –ü—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç | ‚úÖ |
| `OPENROUTER_MODEL` | `openai/gpt-4o-mini` –ø—Ä–∏–º–µ—Ä | `openai/gpt-5-image-mini` | ‚ö†Ô∏è –ù–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è |
| `API_PROXY_SECRET` | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ | –ü—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç (64 chars) | ‚úÖ |
| `LOG_LEVEL` | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: INFO | DEBUG | ‚ö†Ô∏è |
| `MAX_IMAGE_SIZE_BYTES` | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: 5242880 | (–Ω–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ, –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è default) | ‚úÖ |

‚ö†Ô∏è **–ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–ï:** LOG_LEVEL —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ DEBUG –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ (–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç INFO).

### 8.2 API_CONTRACT.md
| –ê—Å–ø–µ–∫—Ç | –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è | –†–µ–∞–ª—å–Ω–æ—Å—Ç—å | –°—Ç–∞—Ç—É—Å |
|--------|--------------|------------|--------|
| Health endpoint | `{"status":"ok"}` | `{"status":"ok"}` | ‚úÖ |
| –¢—Ä–µ–±—É–µ—Ç—Å—è auth | –î–∞ (X-API-Key) | –î–∞ (401/422 –µ—Å–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç) | ‚úÖ |
| –ó–∞–≥–æ–ª–æ–≤–∫–∏ –æ—Ç–≤–µ—Ç–∞ | `X-Request-ID` | –ü—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç | ‚úÖ |
| –ö–æ–¥—ã –æ—à–∏–±–æ–∫ | 400/401/413/422/500 | –†–∞–±–æ—Ç–∞–µ—Ç | ‚úÖ |
| –°—Ö–µ–º–∞ –æ—Ç–≤–µ—Ç–∞ | `items`, `total`, `model_notes` | ‚ùå –ü—Ä–æ–≤–∞–ª –≤–∞–ª–∏–¥–∞—Ü–∏–∏ | ‚ö†Ô∏è |

‚ö†Ô∏è **–ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–ï:** –§–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ç–≤–µ—Ç—ã API –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Å—Ö–µ–º–µ –∏–∑-–∑–∞ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è `carbs` vs `carbohydrates`.

### 8.3 RUNBOOK.md
| –ö–æ–º–∞–Ω–¥–∞ | –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è | –†–µ–∞–ª—å–Ω–æ—Å—Ç—å | –°—Ç–∞—Ç—É—Å |
|---------|--------------|------------|--------|
| `docker compose ps` | –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç—É—Å | –†–∞–±–æ—Ç–∞–µ—Ç | ‚úÖ |
| `curl /health` | –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç 200 | –†–∞–±–æ—Ç–∞–µ—Ç | ‚úÖ |
| `docker exec ... id` | uid=1000(appuser) | –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ | ‚úÖ |
| `docker stats` | –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤ | –†–∞–±–æ—Ç–∞–µ—Ç | ‚úÖ |
| –ö–æ–º–∞–Ω–¥—ã health check | curl -f /health | –†–∞–±–æ—Ç–∞–µ—Ç | ‚úÖ |

‚úÖ **PASS:** –í—Å–µ –∫–æ–º–∞–Ω–¥—ã –∏–∑ RUNBOOK —Ä–∞–±–æ—Ç–∞—é—Ç —Å–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏.

---

## 9. –ù–∞–π–¥–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï
–ù–µ –Ω–∞–π–¥–µ–Ω–æ.

### üü° –ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–Ø

1. **LOG_LEVEL=DEBUG –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ**
   - **–í–ª–∏—è–Ω–∏–µ:** –£–≤–µ–ª–∏—á–µ–Ω–Ω—ã–π –æ–±—ä—ë–º –ª–æ–≥–æ–≤, –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –Ω–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –ø–æ–¥—Ä–æ–±–Ω–∞—è –æ—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –≤ –ª–æ–≥–∞—Ö.
   - **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –ò–∑–º–µ–Ω–∏—Ç—å –Ω–∞ `LOG_LEVEL=INFO` –≤ `.env` –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å.
   - **–§–∞–π–ª:** `/opt/eatfit24-ai-proxy/.env`

2. **–û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–∞ AI**
   - **–í–ª–∏—è–Ω–∏–µ:** `/api/v1/ai/recognize-food` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫–∏ 500 –∏–∑-–∑–∞ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Å—Ö–µ–º—ã.
   - **–°–∏–º–ø—Ç–æ–º:** –ú–æ–¥–µ–ª—å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `carbs`, –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ–∂–∏–¥–∞–µ—Ç `carbohydrates`.
   - **–î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞:** –û—à–∏–±–∫–∞ –≤ –ª–æ–≥–∞—Ö: `Field required [type=missing, input_value={...,'carbs': 0.0}]`
   - **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –û–±–Ω–æ–≤–∏—Ç—å [app/openrouter_client.py](app/openrouter_client.py) –∏–ª–∏ [app/schemas.py](app/schemas.py) –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ–±–æ–∏—Ö –Ω–∞–∑–≤–∞–Ω–∏–π –ø–æ–ª–µ–π.
   - **–°–≤—è–∑–∞–Ω–æ:** –ö–æ–º–º–∏—Ç `78e8a93` ("Remove Pydantic aliases") –≤–æ–∑–º–æ–∂–Ω–æ –Ω–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ—à–∏–ª —ç—Ç—É –ø—Ä–æ–±–ª–µ–º—É.

3. **Docker –ø—Ä–∏–≤—è–∑–∞–Ω –∫ 0.0.0.0:8001**
   - **–í–ª–∏—è–Ω–∏–µ:** –°–µ—Ä–≤–∏—Å –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ –≤—Å–µ—Ö —Å–µ—Ç–µ–≤—ã—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞—Ö (—Å–º—è–≥—á–µ–Ω–æ ufw firewall).
   - **–¢–µ–∫—É—â–∞—è –∑–∞—â–∏—Ç–∞:** ufw —Ä–∞–∑—Ä–µ—à–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å–µ—Ç—å Tailscale (100.0.0.0/8).
   - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ü—Ä–∏–≤—è–∑–∞—Ç—å –Ω–∞–ø—Ä—è–º—É—é –∫ IP Tailscale –≤ docker-compose.yml –¥–ª—è —ç—à–µ–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∑–∞—â–∏—Ç—ã.
   - **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
     ```yaml
     ports:
       - "100.84.210.65:8001:8001"  # –í–º–µ—Å—Ç–æ "8001:8001"
     ```

4. **–ù–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π ID –º–æ–¥–µ–ª–∏**
   - **–ú–æ–¥–µ–ª—å:** `openai/gpt-5-image-mini`
   - **–ü—Ä–æ–±–ª–µ–º–∞:** –≠—Ç–æ—Ç ID –º–æ–¥–µ–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ OpenRouter (–ø–æ —Å–æ—Å—Ç–æ—è–Ω–∏—é –Ω–∞ –¥–µ–∫–∞–±—Ä—å 2025).
   - **–†–∏—Å–∫:** –ú–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å—Å—è, –µ—Å–ª–∏ –º–æ–¥–µ–ª—å –±—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω–∞ –∏–ª–∏ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∞.
   - **–î–µ–π—Å—Ç–≤–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫—É –º–æ–¥–µ–ª–∏. –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π, —Ç–∞–∫–∏—Ö –∫–∞–∫ `openai/gpt-4o-mini`.

5. **–ü—Ä–∞–≤–∞ —Ñ–∞–π–ª–∞ .env –Ω–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã**
   - **–†–∏—Å–∫:** –ï—Å–ª–∏ `.env` –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è —á—Ç–µ–Ω–∏—è –≤—Å–µ–º, —Å–µ–∫—Ä–µ—Ç—ã —Ä–∞—Å–∫—Ä—ã—Ç—ã.
   - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –í—ã–ø–æ–ª–Ω–∏—Ç—å `chmod 600 /opt/eatfit24-ai-proxy/.env` –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞.

### üü¢ –ò–ù–§–û–†–ú–ê–¶–ò–û–ù–ù–´–ï

1. **–¢–µ—Å—Ç–æ–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏**
   - –§–∞–π–ª: `tests/assets/test_food_image.jpg`
   - –°—Ç–∞—Ç—É—Å: OK (–ª–µ–≥–∏—Ç–∏–º–Ω—ã–π —Ç–µ—Å—Ç–æ–≤—ã–π –∞—Å—Å–µ—Ç, –Ω–µ –º—É—Å–æ—Ä).

2. **–õ–æ–≥–∏–∫–∞ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ –Ω–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª–∞—Å—å**
   - –ê—É–¥–∏—Ç –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–ª –æ–±—Ä–∞–±–æ—Ç–∫—É rate limit 429 –∏–ª–∏ –ø–æ–≤–µ–¥–µ–Ω–∏–µ retry.
   - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å endpoint —Å rate limit (–≤–Ω–µ –æ–±–ª–∞—Å—Ç–∏ —ç—Ç–æ–≥–æ –∞—É–¥–∏—Ç–∞).

---

## 10. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è (–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1)

1. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –æ—Ç–≤–µ—Ç–∞ AI**
   - **–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π:** –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫
   - **–ó–∞–¥–∞—á–∞:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å [app/openrouter_client.py](app/openrouter_client.py) –∏ —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –ø–æ–ª—è –æ—Ç–≤–µ—Ç–∞ –º–æ–¥–µ–ª–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –º–∞–ø—è—Ç—Å—è –Ω–∞ —Å—Ö–µ–º—É.
   - **–°—Ä–æ–∫:** –î–æ –Ω–∞—á–∞–ª–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ.

2. **–ò–∑–º–µ–Ω–∏—Ç—å LOG_LEVEL –Ω–∞ INFO**
   ```bash
   ssh root@100.84.210.65
   cd /opt/eatfit24-ai-proxy
   sed -i 's/LOG_LEVEL=DEBUG/LOG_LEVEL=INFO/' .env
   docker compose restart
   ```

3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ .env**
   ```bash
   chmod 600 /opt/eatfit24-ai-proxy/.env
   ```

### –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è (–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2)

4. **–ü—Ä–∏–≤—è–∑–∞—Ç—å Docker –∫ IP Tailscale**
   - –û–±–Ω–æ–≤–∏—Ç—å `docker-compose.yml`:
     ```yaml
     ports:
       - "100.84.210.65:8001:8001"
     ```
   - –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å.

5. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å ID –º–æ–¥–µ–ª–∏ OpenRouter**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ `openai/gpt-5-image-mini` –≤–∞–ª–∏–¥–Ω–æ–π.
   - –ï—Å–ª–∏ –Ω–µ—Ç, –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—É—é –º–æ–¥–µ–ª—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, `openai/gpt-4o-mini`).
   - –û–±–Ω–æ–≤–∏—Ç—å `.env` –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å.

### –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è (–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3)

6. **–î–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã**
   - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å end-to-end –ø–æ—Ç–æ–∫ API —Å —Ä–µ–∞–ª—å–Ω—ã–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –∏ OpenRouter.
   - –í–∫–ª—é—á–∏—Ç—å –≤ CI/CD pipeline.

7. **–î–æ–±–∞–≤–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**
   - –ú–µ—Ç—Ä–∏–∫–∏ Prometheus –¥–ª—è –ø–æ–¥—Å—á—ë—Ç–∞ –∑–∞–ø—Ä–æ—Å–æ–≤, –∑–∞–¥–µ—Ä–∂–µ–∫, —É—Ä–æ–≤–Ω—è –æ—à–∏–±–æ–∫.
   - –ê–ª–µ—Ä—Ç–∏–Ω–≥ –Ω–∞ –æ—à–∏–±–∫–∏ 5xx.

8. **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é**
   - –ï—Å–ª–∏ `openai/gpt-5-image-mini` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–∞–º–µ—Ä–µ–Ω–Ω–æ, –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ ENV_CONTRACT.md –ø–æ—á–µ–º—É –æ–Ω–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è.

---

## 11. –ò—Ç–æ–≥–æ–≤—ã–π –≤–µ—Ä–¥–∏–∫—Ç

### –û–±—â–∏–π —Å—Ç–∞—Ç—É—Å: üü° **–ì–û–¢–û–í –ö –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Æ –° –ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–Ø–ú–ò**

–°–µ—Ä–≤–∏—Å **—Ä–∞–∑–≤—ë—Ä–Ω—É—Ç**, –Ω–æ –∏–º–µ–µ—Ç **–Ω–µ–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã**, –∫–æ—Ç–æ—Ä—ã–µ —Å–ª–µ–¥—É–µ—Ç —É—Å—Ç—Ä–∞–Ω–∏—Ç—å:

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –°—Ç–∞—Ç—É—Å | –ü—Ä–∏–º–µ—á–∞–Ω–∏—è |
|-----------|--------|------------|
| ‚úÖ –†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ –∫–æ–¥–∞ | PASS | –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—é |
| ‚úÖ –û—Å–Ω–æ–≤—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ | PASS | –ù–µ–ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, firewall –∞–∫—Ç–∏–≤–µ–Ω |
| ‚úÖ –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å Docker | PASS | –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑–¥–æ—Ä–æ–≤, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤ –≤ –Ω–æ—Ä–º–µ |
| ‚úÖ –õ–æ–≥–∏ –∏ –Ω–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å | PASS | JSON –ª–æ–≥–∏, request IDs, –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ |
| ‚ö†Ô∏è –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å API | –ß–ê–°–¢–ò–ß–ù–û | Auth —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –≤–∞–ª–∏–¥–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞ –ø–∞–¥–∞–µ—Ç |
| ‚ö†Ô∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ | –¢–†–ï–ë–£–ï–¢ –ù–ê–°–¢–†–û–ô–ö–ò | LOG_LEVEL=DEBUG, –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –º–æ–¥–µ–ª—å |

### –ë–ª–æ–∫–µ—Ä—ã –¥–ª—è —Å—Ç–∞—Ç—É—Å–∞ "Production Ready"

- [ ] –ò—Å–ø—Ä–∞–≤–∏—Ç—å –æ—à–∏–±–∫—É –≤–∞–ª–∏–¥–∞—Ü–∏–∏ `carbs` vs `carbohydrates`.
- [ ] –ò–∑–º–µ–Ω–∏—Ç—å LOG_LEVEL –Ω–∞ INFO.
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ `.env` (chmod 600).
- [ ] –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å, —á—Ç–æ `openai/gpt-5-image-mini` —è–≤–ª—è–µ—Ç—Å—è –≤–∞–ª–∏–¥–Ω–æ–π –º–æ–¥–µ–ª—å—é, –∏–ª–∏ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—É—é –º–æ–¥–µ–ª—å.

**–ü–æ—Å–ª–µ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è —ç—Ç–∏—Ö –ø—Ä–æ–±–ª–µ–º —Å–µ—Ä–≤–∏—Å –±—É–¥–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É.**

---

## –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: –ö–æ–º–∞–Ω–¥—ã –∞—É–¥–∏—Ç–∞

–í—Å–µ –∫–æ–º–∞–Ω–¥—ã, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ –≤–æ –≤—Ä–µ–º—è —ç—Ç–æ–≥–æ –∞—É–¥–∏—Ç–∞:

```bash
# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
ssh -i id_ed25519 root@100.84.210.65

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞
cd /opt/eatfit24-ai-proxy
git status
git log -1 --oneline
ls -la

# –°—Ç–∞—Ç—É—Å Docker
docker compose ps
docker inspect --format='{{.State.Health.Status}}' eatfit24-ai-proxy
docker --version && docker compose version

# –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
docker exec eatfit24-ai-proxy id
docker exec eatfit24-ai-proxy printenv | grep -E "OPENROUTER|API_PROXY|LOG_LEVEL"
ss -tulpn | grep 8001
ufw status
ip addr show | grep 'inet '

# –¢–µ—Å—Ç—ã API
curl http://localhost:8001/health
curl -X POST http://localhost:8001/api/v1/ai/recognize-food
curl -X POST http://localhost:8001/api/v1/ai/recognize-food \
  -H "X-API-Key: $API_PROXY_SECRET" \
  -F "image=@/opt/eatfit24-ai-proxy/tests/assets/test_food_image.jpg"

# –õ–æ–≥–∏
docker compose logs --tail=50

# –†–µ—Å—É—Ä—Å—ã
docker stats eatfit24-ai-proxy --no-stream
cat docker-compose.yml
```

---

**–ê—É–¥–∏—Ç –∑–∞–≤–µ—Ä—à—ë–Ω:** 2025-12-22 13:45 UTC
**–í–µ—Ä—Å–∏—è –æ—Ç—á—ë—Ç–∞:** 1.0
